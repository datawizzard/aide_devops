
        <!doctype html>
        <html>
        <head>
          <meta charset="utf-8" />
          <title>Qualitron — Data Quality Report</title>
          <style>
            :root {
              --accent: #00A79D;
              --accent-hover: #008E86;
              --text: #0E141B;
              --text-subtle: #5E6A75;
              --surface: #FFFFFF;
              --surface-alt: #F6F8FA;
              --border: #E6E9EF;
              --radius: 12px;
              --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
              --font-mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace;
            }
            body {
              font-family: var(--font-sans);
              margin: 24px;
              background: var(--surface);
              color: var(--text);
            }
            .brand { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
            .logo-badge {
              padding: 4px 8px;
              border-radius: var(--radius);
              border: 1px solid rgba(0,0,0,0.12);
              color: var(--accent);
              font-weight: 600;
              letter-spacing: 0.06em;
            }
            .brand-title { font-size: 16px; font-weight: 600; }
            .brand-sub { font-size: 12px; color: var(--text-subtle); }
            .rule { border: 1px solid var(--border); padding: 12px; margin: 12px 0; border-radius: var(--radius); background: var(--surface); }
            .status { text-transform: uppercase; font-size: 12px; padding: 2px 6px; border-radius: 999px; margin-left: 8px; }
            .status.passed { background: #e6ffed; color: #036400; border: 1px solid #b5e6bf; }
            .status.failed { background: #ffebe6; color: #970000; border: 1px solid #f3b1a3; }
            .status.error  { background: #fff4e5; color: #8a6d3b; border: 1px solid #ffd9a6; }
            table { border-collapse: collapse; margin-top: 8px; width: 100%; }
            th, td { border: 1px solid var(--border); padding: 6px; font-size: 12px; }
            th { background: var(--surface-alt); text-align: left; }
            pre { white-space: pre-wrap; background: var(--surface-alt); padding: 8px; border: 1px solid var(--border); border-radius: 8px; }
            .meta { display: flex; gap: 16px; color: #333; font-size: 13px; margin: 6px 0; }
            .desc { color: #444; }
            .divider { height: 1px; background: var(--border); margin: 12px 0; }
            .header { display: flex; align-items: baseline; justify-content: space-between; margin-bottom: 8px; }
            .header h1 { margin: 0; font-size: 20px; }
            .ts { color: var(--text-subtle); font-size: 12px; }
          </style>
        </head>
        <body>
          <div class="header">
            <div class="brand">
              <div class="logo-badge">[ QUALITRON ]</div>
              <div>
                <div class="brand-title">Qualitron – AI Data Quality</div>
                <div class="brand-sub">EPAM-inspired single-page UI</div>
              </div>
            </div>
            <div class="ts">Generated 2025-09-09 15:55:11 UTC</div>
          </div>
          <div class="divider"></div>

                <section class="rule">
                  <h2>
                    consistent_product_category_per_month
                    <span class="status n/a">n/a</span>
                  </h2>
                  <div class="meta">
                    <div><b>Severity:</b> HIGH</div>
                    <div><b>Violating rows:</b> None</div>
                  </div>
                  <details>
                    <summary>SQL</summary>
                    <pre>WITH product_category_mapping AS
  (SELECT p.ProductKey,
          ps.ProductCategoryKey,
          t.year,
          t.month
   FROM `aigdqr-ragstoriches`.`adv_works_dw`.`dimproduct` p
   JOIN `aigdqr-ragstoriches`.`adv_works_dw`.`dimproductsubcategory` ps ON p.ProductSubcategoryKey = ps.ProductSubcategoryKey
   JOIN `aigdqr-ragstoriches`.`calendar_ddp`.`v_timeline` t ON t.date = p.StartDate),
     category_inconsistencies AS
  (SELECT pcm.ProductKey,
          pcm.year,
          pcm.month,
          COUNT(DISTINCT pcm.ProductCategoryKey) AS distinct_categories
   FROM product_category_mapping pcm
   GROUP BY pcm.ProductKey,
            pcm.year,
            pcm.month
   HAVING COUNT(DISTINCT pcm.ProductCategoryKey) &gt; 1)
SELECT ci.ProductKey,
       ci.year,
       ci.month,
       &#x27;Product has inconsistent categories within the same calendar month&#x27; AS violation_reason
FROM category_inconsistencies ci</pre>
                  </details>
                  <details>
                    <summary>Validation details</summary>
                    <pre>{}</pre>
                  </details>

                  <p class="desc">Ensure that a product&#x27;s category remains consistent throughout a single calendar month. This rule assumes that the product&#x27;s category can be derived from the ProductCategoryKey in the dimproductsubcategory table, which is linked to the dimproduct table via ProductSubcategoryKey.</p>
                </section>

        </body>
        </html>
